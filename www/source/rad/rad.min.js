/**
 * RAD.js
 * Version: 0.9b
 * Date: 7/11/13
 */
(function(b,e){function l(b,a,h){"function"===typeof b&&(h&&h instanceof Object?b.apply(h,a):b(a))}function m(b){var a={};return{channels:function(){return a},publish:function(h){var c,f,g,d,r,q=h.split("."),l;c=arguments[1];if("view"===q[0]||"service"===q[0])if(c&&c.autocreate||"view"!==q[0])d=q[0]+"."+q[1],b.getView(d,b.extractExtras(c));b.options.debug&&e.console.log("publish:",arguments);c=0;for(d=q.length;c<d;c+=1){f=q[0];g=void 0;for(g=1;g<=c;g+=1)f=f+"."+q[g];l=f;if(a[l])for(f=0,g=a[l].length;f<
    g;f+=1)r=a[l][f],r.callback.apply(r.context,arguments),b.options.debug&&(r=r.context.options||r.context,e.console.log("receiver:"+r.viewID+" channel:"+l,arguments))}},subscribe:function(h,c,f){var g=f.viewID;a[h]||(a[h]=[]);a[h].push({context:f||this,callback:c,ID:g});b.options.debug&&e.console.log(g+" subscribe to channel:"+h,arguments);return this},unsubscribe:function(h,c){var f,g,d;if(!c)return this;d=c.viewID;for(f in a)if(a.hasOwnProperty(f))for(g=a[f].length-1;0<=g;g-=1)if((null===h||h===f)&&
    a[f][g].ID===d&&(b.options.debug&&e.console.log(d+" unsubscribe from channel:"+f,arguments),a[f].splice(g,1),h))return this;return this}}}var k,n;k=new function(b,a,h){var c=this,f={},g={},d=new m(c);c.register=function(f,c){void 0===g[f]?g[f]={creator:c,instance:null}:h.console.log("You try register already registered module:"+f+"!")};c.registerAll=function(f){var a,g,b,d;a=0;for(g=f.length;a<g;a+=1)for(d in b=f[a],b)b.hasOwnProperty(d)&&c.register(d,b[d])};c.startViewOrService=function(a,b){var d;
    d=g[a].instance;if(null===d||void 0===d)d=g[a].creator,"function"!==typeof d?h.console.log("Sorry, but "+a+" wasn't registered!"):(g[a].instance=new d({core:c,application:f,viewID:a,extras:b}),this.options.debug&&h.console.log("create: "+a+" with extras:",b))};c.startPlugin=function(a){var f=g[a].instance;if(null===f||void 0===f)g[a].instance=g[a].creator(this,a);this.options.debug&&h.console.log("start plugin:",a)};c.stop=function(a,f,b){var e=g[a],k,I,s;if(e&&e.instance){s=e.instance;s instanceof
    RAD.Blanks.View&&s.unbindModel();if(s.children)for(I=0,e=s.children.length;I<e;I+=1)c.stop(s.children[I].content,null);h.setTimeout(function(){if(k=g[a].instance)d.unsubscribe(null,k),k.destroy(),g[a].instance=null,l(f,null,b),c.options.debug&&h.console.log("destroy:"+a)},0)}};c.startAll=function(){var a,f;for(a in g)g.hasOwnProperty(a)&&(f=a.split("."),"plugin"===f[0]?this.startPlugin(a):this.startViewOrService(a))};c.stopAll=function(){for(var a in g)g.hasOwnProperty(a)&&this.stop(a)};c.extractExtras=
    function(a){try{return a.extras}catch(f){return null}};c.getView=function(a,f){var b;if(!a)return null;try{b=g[a].instance}catch(d){return h.console.log("Error - not register view:"+a,d),null}if(null===b||void 0===b)c.startViewOrService(a,f);else if(f)try{b.setExtras(f)}catch(e){h.console.log(e)}return g[a].instance};c.getService=c.getView;c.initialize=function(a,b){var d,e;f=a||f;b&&(c.options=b,b.plugins&&h.RAD.utils.isArray(b.plugins)&&c.registerAll(b.plugins));h.RAD&&"function"===typeof h.RAD.prepareEnvironment&&
h.RAD.prepareEnvironment();for(d in g)g.hasOwnProperty(d)&&(e=d.split("."),"plugin"===e[0]&&this.startPlugin(d))};c.getStartedViews=function(){var a,f=[];for(a in g)g.hasOwnProperty(a)&&g[a].instance&&f.push(a);return f};c.document=a;c.window=h;c.$=b;c.subscribe=d.subscribe;c.publish=d.publish;c.channels=d.channels;c.unsubscribe=d.unsubscribe;return c}(e.jQuery,b,e);n=function(b,a){var h,c;if(e.RAD.utils.isArray(b))for(h=0,c=b.length;h<c;h+=1)k.register(b[h],a);else k.register(b,a)};e.RAD={views:{},
    services:{},plugins:{},models:{},utils:{},core:k,view:n,service:n,plugin:n,model:function(b,a,h){b=b.split(".");var c=e.RAD.models,f,g;f=b.length;for(g=0;g<f;g+=1)void 0===c[b[g]]&&(g===f-1?a&&(c[b[g]]="function"!==typeof a||void 0!==h&&!0!==h?a:new a):c[b[g]]={}),c=c[b[g]];return c},Class:null};e.RAD.scriptLoader=function(){function k(a,c){var d=b.createElement("script");d.type="text/javascript";d.async=!0;d.readyState?d.onreadystatechange=function(){if("loaded"===d.readyState||"complete"===d.readyState)d.onreadystatechange=
    null,c()}:d.onload=function(){c()};d.src=a;b.head.appendChild(d)}function a(a,b,d){function h(){n+=1;n===m&&l(b,null,d)}var e,m=a.length,n=0;c.arr=null;c.callback=null;c.context=null;for(e=0;e<m;e+=1)k(a[e],h)}function h(){c.loadScripts=a;c.arr&&c.callback&&c.loadScripts(c.arr,c.callback,c.context)}var c={loadScripts:function(a,b,d){c.arr=a;c.callback=b;c.context=d}};e.attachEvent?e.attachEvent("onload",h):e.addEventListener("load",h,!1);return c}();(function(){var e=b.createElement("style");e.appendChild(b.createTextNode('html,body{position:relative;height:100%;overflow:hidden;-ms-touch-action:none;-ms-touch-select:none}body{margin:0;-webkit-text-size-adjust:100%;-webkit-touch-callout:none;-webkit-text-size-adjust:none;-webkit-highlight:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{-moz-user-select:none;-o-user-select:none;-khtml-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}a,input,textarea,button,div{-webkit-tap-highlight-color:rgba(0,0,0,0);-moz-user-select:text;-o-user-select:text;-khtml-user-select:text;-webkit-user-select:text;-ms-user-select:text;user-select:text}img{border-style:none}input,textarea,select{vertical-align:middle}form,fieldset{margin:0;padding:0;border-style:none}div[data-role="view"]{position:absolute;top:0;left:0;width:100%;height:100%;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}#screen{position:relative;height:100%;overflow:hidden}#overlay{display:none}#overlay{position:absolute;z-index:1000;left:0;top:0;width:100%;height:100%}#overlay.show{display:block}.lightbox{position:absolute;z-index:999;left:0;top:0;width:100%;height:100%;opacity:0;text-align:center;white-space:nowrap;-webkit-transition:opacity 300ms ease;-moz-transition:opacity 300ms ease;-ms-transition:opacity 300ms ease;-o-transition:opacity 300ms ease;transition:opacity 300ms ease}.lightbox.show{opacity:1}.lightbox:after{content:"";display:inline-block;vertical-align:middle;width:1px;height:100%}.lightbox-frame{position:relative;display:inline-block;vertical-align:middle;width:100%;text-align:left;white-space:normal;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-moz-transform:scale(0.5,0.5);-webkit-transform:scale(0.5,0.5);-o-transform:scale(0.5,0.5);-ms-transform:scale(0.5,0.5);transform:scale(0.5,0.5);-webkit-transition:-webkit-transform 300ms ease;-moz-transition:-moz-transform 300ms ease;-ms-transition:-ms-transform 300ms ease;-o-transition:-o-transform 300ms ease;transition:transform 300ms ease}.lightbox.show .lightbox-frame{-moz-transform:scale(1,1);-webkit-transform:scale(1,1);-o-transform:scale(1,1);-ms-transform:scale(1,1);transform:scale(1,1)}.toast{z-index:999;position:absolute;width:auto!important;max-width:50%!important;height:auto!important;opacity:0;-webkit-transition:opacity 300ms ease;-moz-transition:opacity 300ms ease;-ms-transition:opacity 300ms ease;-o-transition:opacity 300ms ease;transition:opacity 300ms ease;text-align:center;display:inline-block}.toast.show{opacity:1;-webkit-transition:opacity 10ms ease;-moz-transition:opacity 10ms ease;-ms-transition:opacity 10ms ease;-o-transition:opacity 10ms ease;transition:opacity 10ms ease}.popup{position:absolute;z-index:999;opacity:0;-webkit-transition:opacity 300ms ease;-moz-transition:opacity 300ms ease;-ms-transition:opacity 300ms ease;-o-transition:opacity 300ms ease;transition:opacity 300ms ease}.popup.show{opacity:1}.slide-in,.slide-out{-webkit-transition:-webkit-transform 350ms ease;-moz-transition:-moz-transform 350ms ease;-ms-transition:-ms-transform 350ms ease;-o-transition:-o-transform 350ms ease;transition:transform 350ms ease}.new-page.slide-in{-webkit-transform:translate3d(100%,0,0);-moz-transform:translate3d(100%,0,0);-ms-transform:translate3d(100%,0,0);-o-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}.old-page.slide-in{-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);-o-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.animate>.new-page.slide-in{-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);-o-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.animate>.old-page.slide-in{-webkit-transform:translate3d(-100%,0,0);-moz-transform:translate3d(-100%,0,0);-ms-transform:translate3d(-100%,0,0);-o-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}.new-page.slide-out{-webkit-transform:translate3d(-100%,0,0);-moz-transform:translate3d(-100%,0,0);-ms-transform:translate3d(-100%,0,0);-o-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}.old-page.slide-out{-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);-o-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.animate>.new-page.slide-out{-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);-o-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.animate>.old-page.slide-out{-webkit-transform:translate3d(100%,0,0);-moz-transform:translate3d(100%,0,0);-ms-transform:translate3d(100%,0,0);-o-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}.new-page.fade-in,.new-page.fade-out{opacity:0;-webkit-transition:opacity 350ms ease;-moz-transition:opacity 350ms ease;-ms-transition:opacity 350ms ease;-o-transition:opacity 350ms ease;transition:opacity 350ms ease}.old-page.fade-in,.old-page.fade-out{opacity:1;-webkit-transition:opacity 175ms 175ms ease;-moz-transition:opacity 175ms 175ms ease;-ms-transition:opacity 175ms 175ms ease;-o-transition:opacity 175ms 175ms ease;transition:opacity 175ms 175ms ease}.animate>.new-page.fade-in,.animate>.new-page.fade-out{opacity:1}.animate>.old-page.fade-in,.animate>.old-page.fade-out{opacity:0}'));
    b.head.appendChild(e)})();e.RAD.prepareEnvironment=function(){function l(a){a.stopPropagation();a.preventDefault()}var a=/ipad/gi.test(e.navigator.appVersion),h=/android/gi.test(e.navigator.appVersion),c=b.querySelector("#overlay");_.templateSettings={evaluate:/\{\{#([\s\S]+?)\}\}/g,interpolate:/\{\{[^#\{]([\s\S]+?)[^\}]\}\}/g,escape:/\{\{\{([\s\S]+?)\}\}\}/g};e.addEventListener("touchmove",function(a){a.preventDefault()},!1);b.body.onselectstart=function(){return!1};a?e.document.body.className="i-pad":
    h&&(e.document.body.className="android");c.addEventListener("click",l,!1);c.addEventListener("touchstart",l,!1);c.addEventListener("touchmove",l,!1);c.addEventListener("touchend",l,!1)}})(document,window);
RAD.Class=RAD.Class||function(){function b(b){return"function"===typeof b}var e=function(){};e.extend=function(e){var m,k=function(e){e!==b&&b(this.initialize)&&this.initialize.apply(this,arguments)};k.prototype=new this(b);for(m in e)(function(e,l){k.prototype[m]=b(e)&&b(l)?function(){this._super=l;return e.apply(this,arguments)}:e})(e[m],k.prototype[m]);k.prototype.constructor=k;k.extend=this.extend||this.create;return k};return e}();
RAD.utils.ElementCreator=function(b,e){var l=document.createElement(b);if(e)for(var m in e)l[m]=e[m];return l};RAD.utils.trim=function(b){return b.replace(/^\s+|\s+$/g,"")};RAD.utils.removeMultipleSpaces=function(b){return b.replace(/\s{2,}/g," ")};RAD.utils.isArray=function(b){var e=!1;"[object Array]"===Object.prototype.toString.call(b)&&(e=!0);return e};
RAD.utils.getCoords=function(b,e){var l,m,k;m=window.pageYOffset;k=window.pageXOffset;var n=b.getBoundingClientRect(),p=n.top+m,n=n.left+k;e&&(l=e.getBoundingClientRect(),m=l.top+m,k=l.left+k,p-=m,n-=k);return{top:Math.round(p),left:Math.round(n)}};RAD.utils.escape=function(b){return b?b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):b};
RAD.utils.unescape=function(b){return b?b.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"'):b};RAD.utils.encodeURI=function(b){return encodeURIComponent(b).replace(/[!'()]/g,escape).replace(/\*/g,"%2A")};RAD.utils.decodeURI=function(b){return decodeURIComponent((b+"").replace(/\+/g,"%20"))};RAD.utils.removeClass=function(b,e){return b.className=b.className.replace(RegExp("(?:^|\\s)"+e+"(?!\\S)","g"),"")};
RAD.utils.dispatchResizeEvent=function(b){var e=document.createEvent("Event");if(!b)return!1;e.initEvent("scrollRefresh",!0,!1);b.dispatchEvent(e)};
RAD.utils.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(b){var e="",l,m,k,n,p,a,h=0,c=RAD.utils.Base64;for(b=c._utf8_encode(b);h<b.length;)l=b.charCodeAt(h++),m=b.charCodeAt(h++),k=b.charCodeAt(h++),n=l>>2,l=(l&3)<<4|m>>4,p=(m&15)<<2|k>>6,a=k&63,isNaN(m)?p=a=64:isNaN(k)&&(a=64),e=e+c._keyStr.charAt(n)+c._keyStr.charAt(l)+c._keyStr.charAt(p)+c._keyStr.charAt(a);return e},decode:function(b){var e="",l,m,k,n,p,a=0,h=RAD.utils.Base64;for(b=b.replace(/[^A-Za-z0-9\+\/\=]/g,
    "");a<b.length;)l=h._keyStr.indexOf(b.charAt(a++)),m=h._keyStr.indexOf(b.charAt(a++)),n=h._keyStr.indexOf(b.charAt(a++)),p=h._keyStr.indexOf(b.charAt(a++)),l=l<<2|m>>4,m=(m&15)<<4|n>>2,k=(n&3)<<6|p,e+=String.fromCharCode(l),64!=n&&(e+=String.fromCharCode(m)),64!=p&&(e+=String.fromCharCode(k));return e=h._utf8_decode(e)},_utf8_encode:function(b){b=b.replace(/\r\n/g,"\n");for(var e="",l=0;l<b.length;l++){var m=b.charCodeAt(l);128>m?e+=String.fromCharCode(m):(127<m&&2048>m?e+=String.fromCharCode(m>>
    6|192):(e+=String.fromCharCode(m>>12|224),e+=String.fromCharCode(m>>6&63|128)),e+=String.fromCharCode(m&63|128))}return e},_utf8_decode:function(b){for(var e="",l=0,m=0,k=0,n=0;l<b.length;)m=b.charCodeAt(l),128>m?(e+=String.fromCharCode(m),l++):191<m&&224>m?(k=b.charCodeAt(l+1),e+=String.fromCharCode((m&31)<<6|k&63),l+=2):(k=b.charCodeAt(l+1),n=b.charCodeAt(l+2),e+=String.fromCharCode((m&15)<<12|(k&63)<<6|n&63),l+=3);return e}};
RAD.utils.QueryFactory=function(){function b(b){function e(a){var b;b=arguments;var g=[],d;for(d=1;d<b.length;d+=1)g.push(b[d]);b=g;"function"===typeof a&&(h&&h instanceof Object?a.apply(h,b):a.apply(k,b))}var k=this,n=[],p,a,h;"object"===typeof b&&(p=b.success,a=b.error,h=b.context);k.error=function(b){e(a,b)};k.success=function(a){e(p,a)};k.then=function(a){n.push(a);return this};k.next=function(a){var b,g,d;if(0<n.length)if(d=n[0],"[object Array]"===Object.prototype.toString.call(d))if(d.isAlreadyRunning)d.whileCounter+=
    1,d.whileCounter===d.length&&(n.shift(),e(n.shift(),this,a));else for(d.isAlreadyRunning=!0,b=d.whileCounter=0,g=d.length;b<g;b+=1)e(d[b],this,a);else e(n.shift(),this,a);else this.success(a)};k.when=function(){var a,b,g=[];a=0;for(b=arguments.length;a<b;a+=1)g.push(arguments[a]);n.push(g);return this};k.resolve=function(a){this.next(a);this.then=this.when=this.resolve=function(){throw Error("You try use already resolved query");}};return k}var e;this.createQuery=function(l){return e=new b(l)};this.lastQuery=
    function(){return e};return this};RAD.utils.serializeFormToObject=function(b){var e={};b=$(b).find("input, select, textarea, button");var l,m,k,n;k=0;for(n=b.length;k<n;k+=1)l=b.get(k).getAttribute("name")||b.get(k).id||b.get(k).className.replace(" ",""),m=b.get(k).value||"",void 0!==e[l]?(e[l].push||(e[l]=[e[l]]),e[l].push(m)):e[l]=m;return e};RAD.utils.serializeFormToString=function(b){var e;try{e=JSON.stringify(RAD.utils.serializeFormToObject(b))}catch(l){e=""}return e};
RAD.Blanks=function(b,e){function l(){return{listeners:[],done:function(a){this.listeners.push(a)},doneFirstTask:function(a){this.firstTask=a},doneLastTask:function(a){this.lastTask=a},resolve:function(){var a,b,c;this.resolve=function(){};this.doneLastTask=this.doneFirstTask=this.done=function(a){"function"===typeof a&&a()};"function"===typeof this.firstTask&&this.firstTask();a=0;for(b=this.listeners.length;a<b;a+=1)c=this.listeners[a],"function"===typeof c&&c();"function"===typeof this.lastTask&&
this.lastTask();delete this.listeners}}}function m(a,b){var c=n.core.getView(b.content,b.extras),f=a.$el.find(b.container_id);b&&b.backstack&&n.core.publish("router.beginTransition",b);c.appendIn(f,function(){f.attr("view",b.content);"function"===typeof b.callback&&("object"===typeof b.context?b.callback.call(b.context):b.callback())})}var k={},n=b.RAD,p=b._;k.Deferred=l;k.View=b.Backbone.View.extend({className:"backbone-view",attributes:{"data-role":"view"},getChildren:function(){this.children||
(this.children=[]);return this.children},initialize:function(){var a=this,e,c;a.loader=new l;a.renderRequest=!0;a.viewID=a.options.viewID;c=a.options.core;a.publish=c.publish;a.subscribe=c.subscribe;a.unsubscribe=c.unsubscribe;a.$=c.$;a.finish=function(){c.stop(a.viewID)};a.application=a.options.application;a.extras=a.options.extras;delete a.options;e=p.clone(a.getChildren());a.children=e;$.get(a.url,function(f){var c,d,e,h;h=b.$("<div></div>").html(f).find("[data-template]");0<h.length&&(a.innerTemplate=
    []);d=0;for(e=h.length;d<e;d+=1)c=h.get(d),c=c.innerHTML,a.innerTemplate[d]=p.template(n.utils.unescape(c));a.template=p.template(f);a.bindModel(a.model);a.loader.resolve()},"text");a.subscribe(a.viewID,a.receiveMsg,a);a.oninit();a.onInitialize();a.setExtras(a.extras);return a},setExtras:function(a){this.onNewExtras(a);this.extras=a},bindModel:function(a){a&&(this.model=a,this.listenTo(a,"add",this.render),this.listenTo(a,"remove",this.render),this.listenTo(a,"fetch",this.render),this.listenTo(a,
    "sort",this.render),this.listenTo(a,"change",this.render),this.listenTo(a,"reset",this.render),this.template&&a.trigger("change"))},unbindModel:function(){this.model&&(this.stopListening(this.model),this.model=null)},changeModel:function(a){this.unbindModel();this.bindModel(a)},render:function(){var a=this.model?this.model.toJSON():void 0,b,c,f;this.onStartRender();b=this.getChildren();c=0;for(f=b.length;c<f;c+=1){var g=b[c];n.core.getView(g.content,g.extras).detach()}if(this.innerTemplate&&0<this.$el.html().length){c=
    0;for(f=this.innerTemplate.length;c<f;c+=1)this.t_m_p=this.innerTemplate[c],$(this.$inner[c]).html(this.t_m_p({model:a}));delete this.t_m_p}else if(this.$el.html(this.template({model:a})),this.innerTemplate)for(this.$inner=[],a=this.$el.find("[data-template]"),c=0,f=this.innerTemplate.length;c<f;c+=1)this.$inner[c]=a.get(c);c=0;for(f=b.length;c<f;c+=1)m(this,b[c]);this.onrender();this.onEndRender();this.initScrollRefresh();this.renderRequest=!1;return this},appendIn:function(a,e){var c=this,f=$(a);
    a&&0!==f.length?(f.append(c.$el),c.renderRequest?c.loader.doneFirstTask(function(){c.render();c.attachScroll();e()}):(c.attachScroll(),e())):b.console.log("Container for "+c.viewID+" doesn't exist!")},initScrollRefresh:function(a){a=a||this.el;var b=e.createEvent("Event");b.initEvent("scrollRefresh",!0,!0);a.dispatchEvent(b);this.refreshScroll()},receiveMsg:function(a,b){var c=this;switch(a.split(".")[2]){case "attach":c.loader.done(function(){c.onattach();c.onStartAttach(a,b)});break;case "detach":c.ondetach();
    c.onEndDetach(a,b);break;case "attach_complete":c.loader.doneLastTask(function(){c.onEndAttach()});break;default:c.onReceiveMsg(a,b)}return c},detach:function(){this.detachScroll();this.$el.detach()},destroy:function(){var a;this.onDestroy();this.ondestroy();this.unbindModel();this.off(null,null,this);this.unsubscribe(this.viewID,this);this.undelegateEvents();this.$el.removeData().unbind();this.remove();b.Backbone.View.prototype.remove.call(this);for(a in this)this.hasOwnProperty(a)&&delete this[a];
    return this},oninit:function(){},onattach:function(){},ondetach:function(){},onrender:function(){},ondestroy:function(){},attachScroll:function(){},refreshScroll:function(){},detachScroll:function(){},onInitialize:function(){},onNewExtras:function(){},onReceiveMsg:function(){},onStartRender:function(){},onEndRender:function(){},onStartAttach:function(){},onEndAttach:function(){},onEndDetach:function(){},onDestroy:function(){}});k.ScrollableView=k.View.extend({className:"scroll-view",offsetY:0,attachScroll:function(){var a=
    this,e=a.el.querySelector(".scroll-view")||a.el;a.detachScroll();a.loader.done(function(){a.renderRequest||(a.mScroll=new b.iScroll(e,{bounce:!1,onBeforeScrollStart:function(a){for(var b=a.target;1!==b.nodeType;)b=b.parentNode;"SELECT"!==b.tagName&&("INPUT"!==b.tagName&&"TEXTAREA"!==b.tagName)&&a.preventDefault()}}))})},onattach:function(){var a=this;b.setTimeout(function(){a.mScroll&&(a.mScroll.refresh(),a.mScroll.scrollTo(0,a.offsetY,0))},0)},refreshScroll:function(){this.mScroll&&this.mScroll.refresh()},
    detachScroll:function(){this.mScroll&&(this.offsetY=this.mScroll.y,this.mScroll.destroy(),this.mScroll=null)}});k.Toast=k.View.extend({className:"toast",closeTimeOut:void 0,showTime:4E3,close:function(){b.clearTimeout(this.closeTimeOut);var a={content:this.viewID};$(e.body).off("click.close");this.publish("navigation.toast.close",a)},onattach:function(){var a=this;a.closeTimeOut=b.setTimeout(function(){a.close()},a.showTime);$(e.body).one("click.close",function(){a.close()})}});k.Popup=k.ScrollableView.extend({className:"popup",
    close:function(){var a={content:this.viewID,destroy:this.onCloseDestroy},b;b=this.viewID.split(".");b=b[b.length-1];$(e.body).off("tapdown."+b);$(e.body).off("click."+b);this.publish("navigation.popup.close",a)},onattach:function(a,h){function c(){g.close()}function f(a){a.stopPropagation()}var g=this,d;d=g.viewID.split(".");k.ScrollableView.prototype.onattach.call(g);d=d[d.length-1];g.outSideClose&&(g.$el.on("tapdown."+d,f),g.$el.on("click."+d,f),$(e.body).one("tapdown."+d,c),$(e.body).one("click."+
        d,c));$(b).one("orientationchange."+d,c)},ondetach:function(){var a;a=this.viewID.split(".");a=a[a.length-1];$(e.body).off("tapdown."+a);$(e.body).off("click."+a);this.$el.off("tapdown."+a);this.$el.off("click."+a);$(b).off("orientationchange."+a)}});return k}(window,document);
RAD.Blanks.Service=RAD.Class.extend({initialize:function(b){this.publish=b.core.publish;this.subscribe=b.core.subscribe;this.unsubscribe=b.core.unsubscribe;this.serviceID=this.viewID=b.viewID;this.subscribe(this.serviceID,this.onReceiveMsg,this);this.onInitialize()},destroy:function(){this.onDestroy();this.unsubscribe(null,this)},onInitialize:function(){},onReceiveMsg:function(){},onDestroy:function(){}});
RAD.plugin("plugin.fastclick",function(b,e){function l(a,b){q.push(a,b);window.setTimeout(function(){q.splice(0,2)},d)}function m(a){var b,f,c;for(c=0;c<q.length;c+=2)if(b=q[c],f=q[c+1],Math.abs(a.screenX-b)<r&&Math.abs(a.screenY-f)<r)return a.preventDefault(),a.stopPropagation(),!0;l(a.screenX,a.screenY);return!1}function k(a){g.startX=a.touches[0].screenX;g.startY=a.touches[0].screenY;g.touchStartTime=(new Date).getTime();g.move=!1;g.cancelsed=!1;return!0}function n(){g.cancelsed=!0}function p(a){if(Math.abs(a.touches[0].screenX-
    g.startX)>r||Math.abs(a.touches[0].screenY-g.startY)>r)g.move=!0}function a(a){var b=a.changedTouches[0],c=(new Date).getTime()-g.touchStartTime;if(g.move||g.cancelsed||200<c)return!1;window.document.activeElement&&window.document.activeElement!==a.target&&window.document.activeElement.blur();var f;f=a.changedTouches[0];c=window.document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,1,f.screenX,f.screenY,f.clientX,f.clientY,!1,!1,!1,!1,0,null);a.target.dispatchEvent(c);a.target.focus&&
a.target.focus();l(b.screenX,b.screenY);a.preventDefault();a.stopPropagation();return!0}function h(){var a;if(void 0===window.ontouchstart)return!1;if(/Chrome\/[0-9]+/.test(window.navigator.userAgent))if(0<window.navigator.userAgent.indexOf("Android")){if((a=c.querySelector("meta[name=viewport]"))&&-1!==a.content.indexOf("user-scalable=no"))return!1}else return!1;return!0}var c=window.document,f=c.body,g={moduleID:e},d=500,r=10,q=[];g.swipe=new function(a){function b(a){var f={},c=a;d.touch&&(a.touches&&
    a.touches[0]&&"touchend"!==a.type?c=a.touches[0]:a.changedTouches&&a.changedTouches[0]&&(c=a.changedTouches[0]));f.screenX=c.screenX;f.screenY=c.screenY;f.clientX=c.clientX;f.clientY=c.clientY;return f}function f(a,b,d,c){return Math.abs(a-d)>Math.abs(b-c)?a>d?"left":"right":b>c?"top":"bottom"}function e(a,d){var f=b(d),g=c.createEvent("Event");g.initEvent(a,!0,!0);g[a]={clientX:f.clientX,clientY:f.clientY,screenX:f.screenX,screenY:f.screenY,timeStamp:d.timeStamp};d.target.dispatchEvent(g)}function g(a){var d=
    b(a);h=k;k={screenX:d.screenX,screenY:d.screenY,timeStamp:a.timeStamp}}var d=this,h,k;d.down=function(a){var f=b(a);d.startX=f.screenX;d.startY=f.screenY;d.startClientX=f.clientX;d.startClientY=f.clientY;d.timeStamp=a.timeStamp;d.moved=!1;d.isDown=!0;d.touchStartTime=(new Date).getTime();k={screenX:0,screenY:0,timeStamp:(new Date).getTime()};g(a);e("tapdown",a)};d.move=function(a){var f=b(a);d.isDown&&e("tapmove",a);if(Math.abs(f.screenX-d.startX)>r||Math.abs(f.screenY-d.startY)>r)d.moved=!0,g(a)};
    d.cancel=function(a){d.isDown&&e("tapcancel",a)};d.clear=function(a){e("tapclear",a)};d.up=function(a){var g,k=b(a),l,s;s=(new Date).getTime()-d.touchStartTime;if(d.isDown){d.isDown=!1;!d.moved&&200>=s&&e("tap",a);s=k.screenX-h.screenX;l=k.screenY-h.screenY;s=(Math.pow(s*s+l*l,0.5)/(a.timeStamp-h.timeStamp)).toFixed(3);if(d.moved&&0<s){l=h.screenX;var m=h.screenY,n=h.timeStamp,r=k.screenX,q=k.screenY,p=a.timeStamp;switch(f(l,m,r,q)){case "left":g=l-r;break;case "right":g=r-l;break;case "top":g=m-
        q;break;case "bottom":g=q-m}l=(g/(p-n)).toFixed(3);g=c.createEvent("Event");g.initEvent("swipe",!0,!0);g.swipe={start:{screenX:d.startX,screenY:d.startY,clientX:d.startClientX,clientY:d.startClientY,timeStamp:d.timeStamp},end:{screenX:k.screenX,screenY:k.screenY,clientX:k.clientX,clientY:k.clientY,timeStamp:a.timeStamp},velocity:s,direction:f(d.startX,d.startY,k.screenX,k.screenY),speed:l};a.target.dispatchEvent(g)}e("tapup",a)}};d.destroy=function(){this.touch?(this.el.removeEventListener("touchstart",
        this.down),this.el.removeEventListener("touchend",this.up),this.el.removeEventListener("touchmove",this.move),this.el.removeEventListener("touchcancel",this.cancel)):(this.el.removeEventListener("mousedown",this.down),this.el.removeEventListener("mouseup",this.up),this.el.removeEventListener("mousemove",this.move),this.el.removeEventListener("mouseout",this.cancel),this.el.removeEventListener("mouseover",this.clear));delete this.el};d.el=a;a=null;d.touch=void 0!==window.ontouchstart;d.touch?(d.el.addEventListener("touchstart",
        d.down,!1),d.el.addEventListener("touchend",d.up,!1),d.el.addEventListener("touchmove",d.move,!1),d.el.addEventListener("touchcancel",d.cancel,!1)):(d.el.addEventListener("mousedown",d.down,!1),d.el.addEventListener("mouseup",d.up,!1),d.el.addEventListener("mousemove",d.move,!1),d.el.addEventListener("mouseout",d.cancel,!1),d.el.addEventListener("mouseover",d.clear,!1));return d}(f);h()&&(f.addEventListener("click",m,!0),f.addEventListener("touchstart",k,!1),f.addEventListener("touchend",a,!1),f.addEventListener("touchmove",
    p,!1),f.addEventListener("touchcancel",n,!1));g.destroy=function(){h()&&(f.removeEventListener("click",m,!0),f.removeEventListener("touchstart",k,!1),f.removeEventListener("touchend",a,!1),f.removeEventListener("touchmove",p,!1),f.removeEventListener("touchcancel",n,!1));this.swipe.destroy()};return g});
RAD.plugin("plugin.navigator",function(b,e){function l(a,b,d){"function"===typeof a&&("object"===typeof b?a.apply(b,d):a(d))}function m(a,b){var d,f=a.querySelector(b);f&&f.getAttribute&&(d=f.getAttribute("view"));return d}function k(a){function d(a){if(!a||!a.parentNode)return null;if((a=a.parentNode)&&a.getAttribute)return(f=a.getAttribute("view"))?f:d(a)}var f;return d(b.document.querySelector(a))}function n(a){var d,f,c,g,e,k=[];if(!a)return k;a=a.getChildren();c=0;for(g=a.length;c<g;c+=1)for(d=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          a[c].content,k.push(d),e=n(b.getView(d)),d=0,f=e.length;d<f;d+=1)k.push(e[d]);return k}function p(a,c){var g=b.getView(a.content,b.extractExtras(a)),e,k,h=!1;null===g||void 0===g||g.isShown||(g.isShown=!0,e=g.$el,k=function(){h||(h=!0,l(a.callback,a.context,g),q.removeClass("show"),e.off(r,k),b.publish(a.content+".attach",null),g=null)},q.addClass("show"),f.setTimeout(k,d),g.appendIn("body",function(){e.attr("id",a.content);switch(c){case "dialog":e.addClass("lightbox");break;case "toast":var b=g.el,
    d=0,h=0,l=b.offsetWidth,m=b.offsetHeight,n=f.innerWidth,q=f.innerHeight;switch(a.gravity){case "center":d=(n-l)/2;h=(q-m)/2;break;case "left":h=(q-m)/2;break;case "right":d=n-l;h=(q-m)/2;break;case "bottom":d=(n-l)/2;h=q-m;break;default:d=(n-l)/2}b.style.left=Math.round(d+f.pageXOffset)+"px";b.style.top=Math.round(h+f.pageYOffset)+"px";break;case "popup":var b=g.el,d=a.target,h=a.gravity,l=a.width,m=a.height,n=f.innerWidth,q=f.innerHeight,p=l||150,w=m||150,E=0,x=0,y=$(d),F=y.offset().top,A=y.offset().left,
    B=y.outerWidth(),y=y.outerHeight(),M=h&&0<h.length&&-1!=="top bottom left right center".indexOf(h),L=f.getComputedStyle(b),H=b.querySelector(".popup-pointer"),u=0,u=0;M||(h="center",p<A-0&&w<q-0&&(h="left"),p<n-0&&w<q-(F+y)&&(h="bottom"),p<n-(A+B)&&w<q-0&&(h="right"),p<n-0&&w<F-0&&(h="top"));switch(h){case "center":E=(n-p)/2;x=(q-w)/2;break;case "top":E=A-p/2+B/2;x=F-w;break;case "bottom":E=A-p/2+B/2;x=F+y;break;case "left":x=F-w/2+y/2;E=A-p;break;case "right":x=F-w/2+y/2,E=A+B}b.style.left=Math.round(E+
    f.pageXOffset)+"px";b.style.top=Math.round(x+f.pageYOffset)+"px";b.style.width=l+"px";b.style.height=m+"px";if(H){H.style.top="";H.style.left="";H.className="popup-pointer "+h;if("top"===h||"bottom"===h)u=H.offsetWidth/2+parseInt(L.paddingLeft,10),H.style.left=A+Math.round(d.offsetWidth/2)-E-u+"px";if("left"===h||"right"===h)u=H.offsetHeight/2+parseInt(L.paddingTop,10),H.style.top=F+Math.round(d.offsetHeight/2)-x-u+"px"}}e.on(r,k);e.width();e.addClass("show")}))}function a(a){var c=b.getView(a.content),
    g=c.$el,e,h=!1;f.document.activeElement&&f.document.activeElement.blur();e=function(){h||(h=!0,c.detach(),l(a.callback,a.context,c),q.removeClass("show"),g.off(r,e),b.publish(a.content+".detach",null),!a||void 0===a.destroy||a.destroy?b.stop(a.content):c.isShown=!1,c=null)};q.addClass("show");g.on(r,e);f.setTimeout(function(){e()},d);g.removeClass("show")}function h(d,c){function g(a){var d=a?a.backstack:void 0;(d||u&&void 0===d)&&b.publish("router.beginTransition",a)}var e=d.split("."),h;switch(e[1]){case "show":if(f.RAD.utils.isArray(c))for(e=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             0,h=c.length;e<h;e+=1)g(c[e]),C.animate(c[e],!1);else g(c),C.animate(c,!1);break;case "back":e=void 0!==c.direction?c.direction:!0;C.animate(c,e);break;case "toast":case "popup":case "dialog":switch(e[2]){case "show":p(c,e[1]);break;case "close":a(c)}}}var c={},f=b.window,g=b.options.defaultAnimation||"slide",d=b.options.animationTimeout||1E3,r="transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",q,u=b.options&&void 0!==b.options.defaultBackstack?b.options.defaultBackstack:!1,C;C=new function(){function a(d,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          c){var f,e;f=0;for(e=c.length;f<e;f+=1)b.publish(c[f]+"."+d)}var d={inAnimation:0,animate:function(c,e){function h(){f.setTimeout(function(){v&&v.el&&(f.getComputedStyle(v.el,null).getPropertyValue("left"),a("attach",x));G.addClass("animate")},0)}function p(){d.inAnimation-=1;0===d.inAnimation&&q.removeClass("show");l(c.callback,c.context,[v,z]);a("detach",y);a("attach_complete",x);b.publish("router.endTransition",c)}var u,C,v,z,G,t,D,J="",w,E=!1,x,y=[],F,A,B,K;f.document.activeElement&&f.document.activeElement.blur();
    if(null!==c&&void 0!==c)if(D=c.animation||g,G=b.$(c.container_id),v=b.getView(c.content,b.extractExtras(c)),(z=(t=G.attr("view"))?b.getView(t):void 0)&&z.viewID===(v&&v.viewID))f.console.log("You try navigate the same view:"+z.viewID+" as old and new widget!");else{if(t=m(b.document,c.container_id))y=n(b.getView(t)),y.push(t);x=n(v);x.push(c.content);if(t=k(c.container_id)){t=b.getView(t);t=t.getChildren();A={container_id:c.container_id,content:c.content,animation:c.animation};if(t)for(B=0,K=t.length;B<
        K;B+=1)if(F=t[B],F.container_id===A.container_id){t.splice(B,1);break}t.push(A)}G.attr("view",c.content);u=v?v.$el:void 0;C=z?z.$el:void 0;q.addClass("show");d.inAnimation+=1;"none"===c.animation||"none"===g&&!c.animation?(z&&z.detach(),u&&v.appendIn(c.container_id,function(){a("attach",x)}),p()):(w=function(a){a=a&&(v&&a.target===v.el||z&&a.target===z.el);!E&&a&&(G.removeClass("animate"),u&&u.removeClass("new-page "+J),C&&(C.removeClass("old-page "+J),z.detach()),G.off(r,w),p(),E=!0)},G.on(r,w),
        f.setTimeout(w,4E3),J=e?-1!==D.indexOf("-out")?D.replace("-out","-in"):-1!==D.indexOf("-in")?D.replace("-in","-out"):D+"-out":-1!==D.indexOf("-out")||-1!==D.indexOf("-in")?D:D+"-in",C&&C.addClass("old-page "+J),u?(u.addClass("new-page "+J),v.appendIn(G,h)):h())}}};return d};b.subscribe("navigation",h,c);q=b.$("#overlay");c.viewID=e;c.destroy=function(){b.unsubscribe(h,c)};return c});
RAD.plugin("plugin.router",function(b,e){function l(a){var b,d,c;b=a.childNodes;d=0;for(c=b.length;d<c;d+=1)if(b[d].getAttribute&&(a=b[d].getAttribute("view")))return{content:a,container_id:"#"+b[d].getAttribute("id")};d=0;for(c=b.length;d<c;d+=1)if(a=l(b[d]))return a}function m(a){var c,d,e,h,k=[];if(!a)return k;a=a.getChildren();c=0;for(d=a.length;c<d;c+=1)h=_.clone(a[c]),k.push(h),e=h.content,(e=m(b.getView(e)))&&0<e.length&&(h.children=e);k.sort(function(a,b){var d=a.container_id,c=b.container_id,
    f=0;d>c?f=1:d<c&&(f=-1);return f});return k}function k(a){var b={};a=a.split("$$$");b.urlObj=JSON.parse(RAD.utils.decodeURI(a[0]));b.timestamp=a[1];return b}function n(b,c){switch(b.split(".")[1]){case "beginTransition":a.onNewTransition();break;case "endTransition":a.pushToStackRequest&&a.saveScoopeAsURL();break;case "back":a.back();break;case "clear":a.clearAndBlock()}}var p={},a,h=!1,c="function"===typeof history.pushState;a={currentID:Math.floor(1E5*Math.random()),currentURL:void 0,lastURL:void 0,
    toBack:!0,isBlocked:!1,stack:new function(){var a,b=-1,d=[];this.push=function(c){var e;b!==d.length-1&&(e=b+1,d=d.slice(0,e));void 0!==a&&null!==a&&d.push(a);a=c;b=d.length-1};this.getCurrent=function(){return void 0!==a&&null!==a?a:d[b]};this.getNext=function(){var a,c;a=b+1;-1<a&&a<d.length&&(c=d[a],b=a);return c};this.getPrevious=function(){var c,e;a&&(d.push(a),b=d.length-1,a=null);c=b-1;-1<c&&c<d.length&&(e=d[c],b=c);return e};this.clear=function(){a=null;d=[];b=d.length-1};return this},pushToStackRequest:!1,
    navigate:function(a){c?history.pushState({url:a,id:this.currentID},null,null):(h=!0,window.location.href="index.html#!"+a+"%%%"+this.currentID);this.currentURL=this.lastURL=a;this.pushToStackRequest=!1;this.stack.push(a)},saveScoopeAsURL:function(){var a=+(new Date).getTime(),c=l(document.getElementsByTagName("body")[0]),d=b.getView(c.content);(d=m(d))&&0<d.length&&(c.children=d);this.navigate(RAD.utils.encodeURI(JSON.stringify(c))+"$$$"+a)},onNewTransition:function(){this.toBack=!0;this.isBlocked=
        !1;this.pushToStackRequest=!0},back:function(){this.toBack=!0;history.back()},clearAndBlock:function(){this.isBlocked=this.toBack=!0;this.lastURL=this.currentURL=void 0;this.currentID=Math.floor(1E5*Math.random());this.stack.clear()},extractDiffer:function(a,b){var c,e,h;for(c in a)if(a.hasOwnProperty(c)&&"children"!==c&&a[c]!==b[c])return delete b.children,b;if(a.hasOwnProperty("children"))for(c=0,e=a.children.length;c<e&&!(h=this.extractDiffer(a.children[c],b.children[c]));c+=1);return h},onPopState:function(a){var c,
        d;c=!1;d=this.toBack;a.state&&(a.state.id===this.currentID&&this.currentURL&&!this.isBlocked)&&(this.lastURL&&this.lastURL===a.state.url&&(c=!0,d=!d),a=d?this.stack.getPrevious():this.stack.getNext(),d=this.toBack?"back":"forward",a?(c&&(this.toBack=!this.toBack),c=this.extractDiffer(k(this.currentURL).urlObj,k(a).urlObj),c.direction=this.toBack,b.publish("navigation.back",c),this.lastURL=this.currentURL,this.currentURL=a,c.direction=d,b.publish("backstack.pop",c)):b.publish("backstack.empty",{direction:d}))}};
    p.viewID=e;b.subscribe("router",n,p);c?b.window.onpopstate=function(b){a.onPopState(b)}:$(window).bind("hashchange",function(){var b=window.location.href.substring(window.location.href.lastIndexOf("#!")+2).split("%%%"),c=b[0],b=parseInt(b[1],10);h||(c={state:{id:b,url:c}},a.onPopState(c));h=!1});p.destroy=function(){b.unsubscribe(n,p)};return p});